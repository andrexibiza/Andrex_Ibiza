setwd("~/Github/Andrex_Ibiza/DATA5100_Statistical-Methods/Data Mining/Credit-Card-Fraud")
library(tidyverse)
ccf <- read.csv("credit_card_fraud.csv")
str(ccf)
install.packages("naivebayes")
install.packages("psych")
# Load packages
library(tidyverse)
library(naivebayes)
library(psych)
# Load credit card fraud data
df <- read.csv("credit_card_fraud.csv")
str(df)
xtabs(~is_fraud, data = df)
xtabs(~is_fraud+amt, data = df)
str(df)
??chr
df$is_fraud <- as.factor(df$is_fraud)
df$merchant <- as.factor(df$merchant)
df$card <- as.factor(df$card)
df$is_fraud <- as.factor(df$is_fraud)
df$merchant <- as.factor(df$merchant)
df$category <- as.factor(df$category)
str(df)
# Factor variables
df$is_fraud <- as.factor(df$is_fraud)
df$merchant <- as.factor(df$merchant)
df$category <- as.factor(df$category)
df$state <- as.factor(df$state)
df$city <- as.factor(df$city)
str(df)
pairs.panels(df[-1])
pairs.panels(df[-1])
# Factor variables
df$is_fraud <- as.factor(df$is_fraud)
df$merchant <- as.factor(df$merchant)
df$category <- as.factor(df$category)
df$state <- as.factor(df$state)
df$city <- as.factor(df$city)
str(df)
# Visualization
pairs.panels(df[-1])
View(ccf)
# Partition data
set.seed(666)
ind <- sample(2, nrow(df), replace = TRUE, prob = c(0.8, 0.2))
train <- df[ind == 1, ]
test <- df[ind == 2, ]
set.seed(666)
ind <- sample(2, nrow(df), replace = TRUE, prob = c(0.8, 0.2))
train <- df[ind == 1, ]
test <- df[ind == 2, ]
# Naive Bayes model
model <- naive_bayes(is_fraud ~ ., data = train)
model
plot(model)
model <- naive_bayes(is_fraud ~ ., data = train)
plot(model)
model
